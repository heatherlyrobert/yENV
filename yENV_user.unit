#!/usr/local/bin/koios
#   koios-polos (axis of heaven) unit testing meta-language



#23456789-12  123456789-123456789-123456789-12345  123456789-123456789-123456  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-123456789- 
#==(verb)===  ===========(description)===========  =====(function)===========  ========================(arguments)=================================================================  ==(test)==  ==========================(results)=================================================================  ========(var)======= 
SCRP    [ии]  (USER) verify name quality                                         0s   quality         yenv_user_quality                                                            ((01.---))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       prepare for run                                                    - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     prepare for testing                  yENV__unit_quiet                                                                                                                  i_equal     0                                                                                                    

   COND       verify quick success                                               - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call quality                         yenv_user_quality           "member"                                                                                              c_equal     YENV_QUALITY                                                                                         

   COND       attempt with NULL                                                  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call quality                         yenv_user_quality           NULL                                                                                                  c_equal     YENV_WTF                                                                                             

   COND       attempt with empty                                                 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call quality                         yenv_user_quality           ""                                                                                                    c_equal     YENV_WTF                                                                                             

   COND       verify another success                                             - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call quality                         yenv_user_quality           "root"                                                                                                c_equal     YENV_QUALITY                                                                                         

   COND       verify one too short                                               - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call quality                         yenv_user_quality           "ab"                                                                                                  c_equal     YENV_TOOSHORT                                                                                        
     exec     call quality                         yenv_user_quality           "a"                                                                                                   c_equal     YENV_TOOSHORT                                                                                        

   COND       verify with numbers                                                - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call quality                         yenv_user_quality           "hector25"                                                                                            c_equal     YENV_QUALITY                                                                                         

   COND       attempt with bad characters                                        - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call quality                         yenv_user_quality           "three?"                                                                                              c_equal     YENV_BADCHAR                                                                                         
     exec     call quality                         yenv_user_quality           "one two"                                                                                             c_equal     YENV_BADCHAR                                                                                         
     exec     call quality                         yenv_user_quality           "and-a-dash"                                                                                          c_equal     YENV_BADCHAR                                                                                         
     exec     call quality                         yenv_user_quality           "w/o"                                                                                                 c_equal     YENV_BADCHAR                                                                                         
     exec     call quality                         yenv_user_quality           ".period"                                                                                             c_equal     YENV_BADCHAR                                                                                         
     exec     call quality                         yenv_user_quality           "rob.s.heath"                                                                                         c_equal     YENV_BADCHAR                                                                                         

   COND       verify one too long                                                - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call quality                         yenv_user_quality           "123456789-12"                                                                                        c_equal     YENV_TOOLONG                                                                                         
     exec     call quality                         yenv_user_quality           "this_is_a_longer_one"                                                                                c_equal     YENV_TOOLONG                                                                                         

   COND       end the test                                                       - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     wrap up testing                      yENV__unit_end                                                                                                                    i_equal     0                                                                                                    



#23456789-12  123456789-123456789-123456789-12345  123456789-123456789-123456  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-123456789- 
#==(verb)===  ===========(description)===========  =====(function)===========  ========================(arguments)=================================================================  ==(test)==  ==========================(results)=================================================================  ========(var)======= 
SCRP    [ии]  (USER) verify login ability                                        0s   login           yenv_user_login                                                              ((01.---))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       prepare for run                                                    - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     prepare for testing                  yENV__unit_quiet                                                                                                                  i_equal     0                                                                                                    

   COND       verify quick success                                               - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call login check                     yenv_user_login             "/bin/bash"                                                                                           c_equal     YENV_LOGIN                                                                                           

   COND       attempt with NULL                                                  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call login check                     yenv_user_login             NULL                                                                                                  c_equal     YENV_WTF                                                                                             

   COND       attempt with empty                                                 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call login check                     yenv_user_login             ""                                                                                                    c_equal     YENV_WTF                                                                                             

   COND       verify more successes                                              - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call login check                     yenv_user_login             "/bin/sh"                                                                                             c_equal     YENV_LOGIN                                                                                           
     exec     call login check                     yenv_user_login             "/bin/csh"                                                                                            c_equal     YENV_LOGIN                                                                                           
     exec     call login check                     yenv_user_login             "/bin/zsh"                                                                                            c_equal     YENV_LOGIN                                                                                           
     exec     call login check                     yenv_user_login             "/bin/dash"                                                                                           c_equal     YENV_LOGIN                                                                                           

   COND       attempt with other programs                                        - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call login check                     yenv_user_login             "/usr/local/bin/gyges"                                                                                c_equal     YENV_WTF                                                                                             
     exec     call login check                     yenv_user_login             "/bin/true"                                                                                           c_equal     YENV_WTF                                                                                             
     exec     call login check                     yenv_user_login             "/usr/bin/gcc"                                                                                        c_equal     YENV_WTF                                                                                             

   COND       verify a non-login                                                 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call login check                     yenv_user_login             "/sbin/nologin"                                                                                       c_equal     YENV_NOLOGIN                                                                                         
     exec     call login check                     yenv_user_login             "/bin/false"                                                                                          c_equal     YENV_NOLOGIN                                                                                         
     exec     call login check                     yenv_user_login             "/dev/null"                                                                                           c_equal     YENV_NOLOGIN                                                                                         

   COND       end the test                                                       - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     wrap up testing                      yENV__unit_end                                                                                                                    i_equal     0                                                                                                    



#23456789-12  123456789-123456789-123456789-12345  123456789-123456789-123456  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-123456789- 
#==(verb)===  ===========(description)===========  =====(function)===========  ========================(arguments)=================================================================  ==(test)==  ==========================(results)=================================================================  ========(var)======= 
SCRP    [ии]  (USER) verify account active                                       0s   active          yenv_user_active                                                             ((01.---))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       prepare for run                                                    - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     prepare for testing                  yENV__unit_quiet                                                                                                                  i_equal     0                                                                                                    

   COND       verify quick success                                               - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call active check                    yenv_user_active            "x"                                                                                                   c_equal     YENV_ACTIVE                                                                                          

   COND       attempt with NULL                                                  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call active check                    yenv_user_active            NULL                                                                                                  c_equal     YENV_WTF                                                                                             

   COND       verify account with no password                                    - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call active check                    yenv_user_active            ""                                                                                                    c_equal     YENV_NOPASS                                                                                          

   COND       verify locked account                                              - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call active check                    yenv_user_active            "!"                                                                                                   c_equal     YENV_LOCKED                                                                                          

   COND       verify account ready for use                                       - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call active check                    yenv_user_active            "*"                                                                                                   c_equal     YENV_UNSET                                                                                           

   COND       verify password saved local                                        - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call active check                    yenv_user_active            "testing"                                                                                             c_equal     YENV_LOCAL                                                                                           

   COND       end the test                                                       - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     wrap up testing                      yENV__unit_end                                                                                                                    i_equal     0                                                                                                    



#23456789-12  123456789-123456789-123456789-12345  123456789-123456789-123456  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-123456789- 
#==(verb)===  ===========(description)===========  =====(function)===========  ========================(arguments)=================================================================  ==(test)==  ==========================(results)=================================================================  ========(var)======= 
SCRP    [ии]  (USER) verify core data gathering                                  0s   core            yENV_user_data                                                               ((01.---))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
   local      create a name variable               - - - - - - - - - - - - -   char  x_name   [LEN_USER]  = "";                                                                                                                                                                                            
   local      create a uid variable                - - - - - - - - - - - - -   int   x_uid    = -1;                                                                                                                                                                                                         
   local      create a gid variable                - - - - - - - - - - - - -   int   x_gid    = -1;                                                                                                                                                                                                         
   local      create a path variable               - - - - - - - - - - - - -   char  x_dir    [LEN_HUND]  = "";                                                                                                                                                                                             
   local      create a shell variable              - - - - - - - - - - - - -   char  x_shell  [LEN_HUND]  = "";                                                                                                                                                                                             
   local      create a desc variable               - - - - - - - - - - - - -   char  x_qual   = '-';                                                                                                                                                                                                      
   local      create a desc variable               - - - - - - - - - - - - -   char  x_log    = '-';                                                                                                                                                                                                      
   local      create a desc variable               - - - - - - - - - - - - -   char  x_act    = '-';                                                                                                                                                                                                      
   local      create a desc variable               - - - - - - - - - - - - -   char  x_grp    =   0;                                                                                                                                                                                                      
   local      create a desc variable               - - - - - - - - - - - - -   char  l        [LEN_HUND]  = "";                                                                                                                                                                                            
   local      create a desc variable               - - - - - - - - - - - - -   char  g        [LEN_HUND]  = "";                                                                                                                                                                                            

   COND       prepare for run                                                    - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     prepare for testing                  yENV__unit_quiet                                                                                                                  i_equal     0                                                                                                    

   COND       start with a success                                               - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((02.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     preprare input                       - - - - - - - - - - - - -   strcpy (x_name, "root");                                                                                                                                                                                                    
     exec     call user validation                 yENV_user_data              'n'  , x_name       , &x_uid, &x_gid, x_dir , x_shell, &x_qual, &x_log , &x_act , &x_grp , l, g       i_equal     0                                                                                                    

   COND  (0)  validate result                                                    - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((02.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     echo     ...check returned name               - - - - - - - - - - - - -   x_name                                                                                                w_equal     тrootТ                                                                                                
     echo     ...check returned uid                - - - - - - - - - - - - -   x_uid                                                                                                 i_equal     0                                                                                                    
     echo     ...check returned gid                - - - - - - - - - - - - -   x_gid                                                                                                 i_equal     0                                                                                                    
     echo     ...check returned dir                - - - - - - - - - - - - -   x_dir                                                                                                 w_equal     т/rootТ                                                                                               
     echo     ...check returned shell              - - - - - - - - - - - - -   x_shell                                                                                               w_equal     т/bin/bashТ                                                                                           

   COND       attempt a clearly false user                                       - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((02.003))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     preprare input                       - - - - - - - - - - - - -   strcpy (x_name, "hasselback");                                                                                                                                                                                              
     exec     call user validation                 yENV_user_data              'n'  , x_name       , &x_uid, &x_gid, x_dir , x_shell, &x_qual, &x_log , &x_act , &x_grp , l, g       i_lesser    0                                                                                                    
     echo     ...check returned name               - - - - - - - - - - - - -   x_name                                                                                                w_equal     тhasselbackТ                                                                                          
     echo     ...check returned uid                - - - - - - - - - - - - -   x_uid                                                                                                 i_equal     -1                                                                                                   
     echo     ...check returned gid                - - - - - - - - - - - - -   x_gid                                                                                                 i_equal     -1                                                                                                   
     echo     ...check returned dir                - - - - - - - - - - - - -   x_dir                                                                                                 w_equal     тТ                                                                                                   
     echo     ...check returned shell              - - - - - - - - - - - - -   x_shell                                                                                               w_equal     тТ                                                                                                   

   COND       attempt null and empty names                                       - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((02.004))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call user validation                 yENV_user_data              'n'  , NULL         , &x_uid, &x_gid, x_dir , x_shell, &x_qual, &x_log , &x_act , &x_grp , l, g       i_lesser    0                                                                                                    
     echo     ...check returned uid                - - - - - - - - - - - - -   x_uid                                                                                                 i_equal     -1                                                                                                   
     echo     ...check returned gid                - - - - - - - - - - - - -   x_gid                                                                                                 i_equal     -1                                                                                                   
     echo     ...check returned dir                - - - - - - - - - - - - -   x_dir                                                                                                 w_equal     тТ                                                                                                   
     echo     ...check returned shell              - - - - - - - - - - - - -   x_shell                                                                                               w_equal     тТ                                                                                                   
     exec     call user validation                 yENV_user_data              'n'  , ""           , &x_uid, &x_gid, x_dir , x_shell, &x_qual, &x_log , &x_act , &x_grp , l, g       i_lesser    0                                                                                                    
     echo     ...check returned uid                - - - - - - - - - - - - -   x_uid                                                                                                 i_equal     -1                                                                                                   
     echo     ...check returned gid                - - - - - - - - - - - - -   x_gid                                                                                                 i_equal     -1                                                                                                   
     echo     ...check returned dir                - - - - - - - - - - - - -   x_dir                                                                                                 w_equal     тТ                                                                                                   
     echo     ...check returned shell              - - - - - - - - - - - - -   x_shell                                                                                               w_equal     тТ                                                                                                   

   COND       verify defenses on return variables (by uid)                       - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((02.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     preprare input                       - - - - - - - - - - - - -   x_uid = 1000;                                                                                                                                                                                                               
     exec     call user validation                 yENV_user_data              'i'  , NULL         , &x_uid, &x_gid, x_dir , x_shell, &x_qual, &x_log , &x_act , &x_grp , l, g       i_equal     0                                                                                                    
     exec     call user validation                 yENV_user_data              'i'  , x_name       , NULL  , &x_gid, x_dir , x_shell, &x_qual, &x_log , &x_act , &x_grp , l, g       i_lesser    0                                                                                                    
     exec     call user validation                 yENV_user_data              'i'  , x_name       , &x_uid, NULL  , x_dir , x_shell, &x_qual, &x_log , &x_act , &x_grp , l, g       i_equal     0                                                                                                    
     exec     call user validation                 yENV_user_data              'i'  , x_name       , &x_uid, &x_gid, NULL  , x_shell, &x_qual, &x_log , &x_act , &x_grp , l, g       i_equal     0                                                                                                    
     exec     call user validation                 yENV_user_data              'i'  , x_name       , &x_uid, &x_gid, x_dir , NULL   , &x_qual, &x_log , &x_act , &x_grp , l, g       i_equal     0                                                                                                    

   COND       verify another success, with literal                               - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((02.005))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call user validation                 yENV_user_data              'n'  , "member"     , &x_uid, &x_gid, x_dir , x_shell, &x_qual, &x_log , &x_act , &x_grp , l, g       i_equal     0                                                                                                    

   COND  (1)  validate result                                                    - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((02.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     echo     ...check returned uid                - - - - - - - - - - - - -   x_uid                                                                                                 i_equal     1000                                                                                                 
     echo     ...check returned gid                - - - - - - - - - - - - -   x_gid                                                                                                 i_equal     1000                                                                                                 
     echo     ...check returned dir                - - - - - - - - - - - - -   x_dir                                                                                                 w_equal     т/home/memberТ                                                                                        
     echo     ...check returned shell              - - - - - - - - - - - - -   x_shell                                                                                               w_equal     т/bin/bashТ                                                                                           

   COND       verify a strange home dir                                          - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((02.008))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     preprare input                       - - - - - - - - - - - - -   strcpy (x_name, "portage");                                                                                                                                                                                                 
     exec     call user validation                 yENV_user_data              'n'  , x_name       , &x_uid, &x_gid, x_dir , x_shell, &x_qual, &x_log , &x_act , &x_grp , l, g       i_equal     0                                                                                                    
     echo     ...check returned name               - - - - - - - - - - - - -   x_name                                                                                                w_equal     тportageТ                                                                                             
     echo     ...check returned uid                - - - - - - - - - - - - -   x_uid                                                                                                 i_equal     250                                                                                                  
     echo     ...check returned gid                - - - - - - - - - - - - -   x_gid                                                                                                 i_equal     250                                                                                                  
     echo     ...check returned dir                - - - - - - - - - - - - -   x_dir                                                                                                 w_equal     т/var/lib/portage/homeТ                                                                               
     echo     ...check returned shell              - - - - - - - - - - - - -   x_shell                                                                                               w_equal     т/sbin/nologinТ                                                                                        

   COND       verify defenses on return variables (by name)                      - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((02.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     preprare input                       - - - - - - - - - - - - -   strcpy (x_name, "portage");                                                                                                                                                                                                 
     exec     call user validation                 yENV_user_data              'n'  , NULL         , &x_uid, &x_gid, x_dir , x_shell, &x_qual, &x_log , &x_act , &x_grp , l, g       i_lesser    0                                                                                                    
     exec     call user validation                 yENV_user_data              'n'  , x_name       , NULL  , &x_gid, x_dir , x_shell, &x_qual, &x_log , &x_act , &x_grp , l, g       i_equal     0                                                                                                    
     exec     call user validation                 yENV_user_data              'n'  , x_name       , &x_uid, NULL  , x_dir , x_shell, &x_qual, &x_log , &x_act , &x_grp , l, g       i_equal     0                                                                                                    
     exec     call user validation                 yENV_user_data              'n'  , x_name       , &x_uid, &x_gid, NULL  , x_shell, &x_qual, &x_log , &x_act , &x_grp , l, g       i_equal     0                                                                                                    
     exec     call user validation                 yENV_user_data              'n'  , x_name       , &x_uid, &x_gid, x_dir , NULL   , &x_qual, &x_log , &x_act , &x_grp , l, g       i_equal     0                                                                                                    

   COND       verify by user id                                                  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((02.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     preprare input                       - - - - - - - - - - - - -   x_uid = 1000;                                                                                                                                                                                                               
     exec     call user validation                 yENV_user_data              'i'  , x_name       , &x_uid, &x_gid, x_dir , x_shell, &x_qual, &x_log , &x_act , &x_grp , l, g       i_equal     0                                                                                                    
     echo     ...check returned name               - - - - - - - - - - - - -   x_name                                                                                                w_equal     тmemberТ                                                                                              
     echo     ...check returned uid                - - - - - - - - - - - - -   x_uid                                                                                                 i_equal     1000                                                                                                 
     echo     ...check returned gid                - - - - - - - - - - - - -   x_gid                                                                                                 i_equal     1000                                                                                                 
     echo     ...check returned dir                - - - - - - - - - - - - -   x_dir                                                                                                 w_equal     т/home/memberТ                                                                                        
     echo     ...check returned shell              - - - - - - - - - - - - -   x_shell                                                                                               w_equal     т/bin/bashТ                                                                                           

   COND       attempt an illegal user id                                         - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((02.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     preprare input                       - - - - - - - - - - - - -   x_uid =  367;                                                                                                                                                                                                               
     exec     call user validation                 yENV_user_data              'i'  , x_name       , &x_uid, &x_gid, x_dir , x_shell, &x_qual, &x_log , &x_act , &x_grp , l, g       i_lesser    0                                                                                                    
     echo     ...check returned name               - - - - - - - - - - - - -   x_name                                                                                                w_equal     тТ                                                                                                    
     echo     ...check returned uid                - - - - - - - - - - - - -   x_uid                                                                                                 i_equal     367                                                                                                  
     echo     ...check returned gid                - - - - - - - - - - - - -   x_gid                                                                                                 i_equal     -1                                                                                                   
     echo     ...check returned dir                - - - - - - - - - - - - -   x_dir                                                                                                 w_equal     тТ                                                                                                   
     echo     ...check returned shell              - - - - - - - - - - - - -   x_shell                                                                                               w_equal     тТ                                                                                                   

   COND       appempt with bad types                                             - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((02.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call user validation                 yENV_user_data               0   , x_name       , &x_uid, &x_gid, x_dir , x_shell, &x_qual, &x_log , &x_act , &x_grp , l, g       i_lesser    0                                                                                                    
     exec     call user validation                 yENV_user_data              'N'  , x_name       , &x_uid, &x_gid, x_dir , x_shell, &x_qual, &x_log , &x_act , &x_grp , l, g       i_lesser    0                                                                                                    
     exec     call user validation                 yENV_user_data              '/'  , x_name       , &x_uid, &x_gid, x_dir , x_shell, &x_qual, &x_log , &x_act , &x_grp , l, g       i_lesser    0                                                                                                    

   COND       end the test                                                       - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     wrap up testing                      yENV__unit_end                                                                                                                    i_equal     0                                                                                                    



#23456789-12  123456789-123456789-123456789-12345  123456789-123456789-123456  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-123456789- 
#==(verb)===  ===========(description)===========  =====(function)===========  ========================(arguments)=================================================================  ==(test)==  ==========================(results)=================================================================  ========(var)======= 
SCRP    [ии]  (USER) verify adding and deleting users                            10s  unittest        yENV_user_add, yENV_user_del, yENV_user_purge                                ((01.---))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
   local      create a name variable               - - - - - - - - - - - - -   char  x_name  [LEN_TERSE] = "";                                                                                                                                                                                            
   local      create a uid variable                - - - - - - - - - - - - -   int   x_uid  = -1;                                                                                                                                                                                                         
   local      create a gid variable                - - - - - - - - - - - - -   int   x_gid  = -1;                                                                                                                                                                                                         
   local      create a path variable               - - - - - - - - - - - - -   char  x_dir   [LEN_HUND]  = "";                                                                                                                                                                                            
   local      create a shell variable              - - - - - - - - - - - - -   char  x_shell [LEN_HUND]  = "";                                                                                                                                                                                            
   local      create a desc variable               - - - - - - - - - - - - -   char  x_qual   = '-';                                                                                                                                                                                                      
   local      create a desc variable               - - - - - - - - - - - - -   char  x_log    = '-';                                                                                                                                                                                                      
   local      create a desc variable               - - - - - - - - - - - - -   char  x_act    = '-';                                                                                                                                                                                                      
   local      create a desc variable               - - - - - - - - - - - - -   char  x_grp    =   0;                                                                                                                                                                                                      
   local      create a desc variable               - - - - - - - - - - - - -   char  l        [LEN_HUND]  = "";                                                                                                                                                                                            
   local      create a desc variable               - - - - - - - - - - - - -   char  g        [LEN_HUND]  = "";                                                                                                                                                                                            
   local      create working variable              - - - - - - - - - - - - -   int        io, ig, ip;                                                                                                                                                                                                     

   COND       prepare for run                                                    - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     prepare for testing                  yENV__unit_quiet                                                                                                                  i_equal     0                                                                                                    

   COND       prepare                                                            - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     remove user                          yENV_user_del               "USR_some"                                                                                            i_equal     1                                                                                                    
     exec     remove user                          yENV_user_del               "USR_guy"                                                                                             i_equal     1                                                                                                    

   COND       verify quick creation success                                      - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     make user                            yENV_user_add               "USR_some"           , 9000 , 'y'  , 'b'                                                              i_equal     0                                                                                                    
     exec     call user validation                 yENV_user_data              'n'  , "USR_some"   , &x_uid, &x_gid, x_dir , x_shell, &x_qual, &x_log , &x_act , &x_grp , l, g       i_equal     0                                                                                                    
     echo     ...check returned uid                - - - - - - - - - - - - -   x_uid                                                                                                 i_equal     9000                                                                                                 
     echo     ...check returned gid                - - - - - - - - - - - - -   x_gid                                                                                                 i_equal     65534                                                                                                
     echo     ...check returned dir                - - - - - - - - - - - - -   x_dir                                                                                                 w_equal     т/home/USR_someТ                                                                                         
     echo     ...check returned shell              - - - - - - - - - - - - -   x_shell                                                                                               w_equal     т/bin/bashТ                                                                                          

   COND       verify home directory                                              - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call detail                          yENV_detail                 "/home/USR_some"    ,NULL, &io,NULL, &ig,NULL, &ip,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL   c_equal     'd'                                                                                                  
     echo     ... check user id                    - - - - - - - - - - - - -   io                                                                                                    i_equal     9000                                                                                                 
     echo     ... check group id                   - - - - - - - - - - - - -   ig                                                                                                    i_equal     65534                                                                                                
     echo     ... check permissions                - - - - - - - - - - - - -   ip                                                                                                    i_equal     0755                                                                                                 

   COND       verify quick deletion success                                      - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     remove user                          yENV_user_del               "USR_some"                                                                                            i_equal     0                                                                                                    
     exec     call user validation                 yENV_user_data              'n'  , "USR_some"   , &x_uid, &x_gid, x_dir , x_shell, &x_qual, &x_log , &x_act , &x_grp , l, g       i_lesser    0                                                                                                    
     echo     ...check returned uid                - - - - - - - - - - - - -   x_uid                                                                                                 i_equal     -1                                                                                                   
     echo     ...check returned gid                - - - - - - - - - - - - -   x_gid                                                                                                 i_equal     -1                                                                                                   
     echo     ...check returned dir                - - - - - - - - - - - - -   x_dir                                                                                                 w_equal     тТ                                                                                                   
     echo     ...check returned shell              - - - - - - - - - - - - -   x_shell                                                                                               w_equal     тТ                                                                                                   

   COND       verify home directory is gone                                      - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call detail                          yENV_detail                 "/home/USR_some"    ,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL   c_equal     '-'                                                                                                  

   COND       attempt to create critical directory                               - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     make user                            yENV_user_add               "member"             , 9001 , '-'  , 'b'                                                              i_lesser    0                                                                                                    
     exec     make user                            yENV_user_add               "root"               , 9002 , '-'  , 'b'                                                              i_lesser    0                                                                                                    

   COND       verify creating a nologin without a home                           - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     make user                            yENV_user_add               "USR_guy"            , 9876 , '-'  , '-'                                                              i_equal     0                                                                                                    
     exec     call user validation                 yENV_user_data              'n'  , "USR_guy"    , &x_uid, &x_gid, x_dir , x_shell, &x_qual, &x_log , &x_act , &x_grp , l, g       i_equal     0                                                                                                    
     echo     ...check returned uid                - - - - - - - - - - - - -   x_uid                                                                                                 i_equal     9876                                                                                                 
     echo     ...check returned gid                - - - - - - - - - - - - -   x_gid                                                                                                 i_equal     65534                                                                                                
     echo     ...check returned dir                - - - - - - - - - - - - -   x_dir                                                                                                 w_equal     т/home/USR_guyТ                                                                                          
     echo     ...check returned shell              - - - - - - - - - - - - -   x_shell                                                                                               w_equal     т/sbin/nologinТ                                                                                      

   COND       verify home directory was never created                            - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call detail                          yENV_exists                 "/home/USR_guy"                                                                                       c_equal     '-'                                                                                                  

   COND       verify deleting user                                               - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     remove user                          yENV_user_del               "USR_guy"                                                                                             i_equal     0                                                                                                    
     exec     call user validation                 yENV_user_data              'n'  , "USR_guy"    , NULL  , NULL  , NULL  , NULL   , &x_qual, &x_log , &x_act , &x_grp , l, g       i_lesser    0                                                                                                    

   COND       verify adding users                                                - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     make user                            yENV_user_add               "USR_some"           , 9000 , 'y'  , 'b'                                                              i_equal     0                                                                                                    
     exec     make user                            yENV_user_add               "USR_guy"            , 9876 , '-'  , '-'                                                              i_equal     0                                                                                                    

   COND       verify purging unit test users                                     - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call purge                           yENV_user_purge                                                                                                                   i_equal     2                                                                                                    
     exec     call user validation                 yENV_user_data              'n'  , "USR_some"   , &x_uid, NULL  , NULL  , NULL   , &x_qual, &x_log , &x_act , &x_grp , l, g       i_lesser    0                                                                                                    
     echo     ...check returned uid                - - - - - - - - - - - - -   x_uid                                                                                                 i_equal     -1                                                                                                   
     exec     call user validation                 yENV_user_data              'n'  , "USR_guy"    , &x_uid, NULL  , NULL  , NULL   , &x_qual, &x_log , &x_act , &x_grp , l, g       i_lesser    0                                                                                                    
     echo     ...check returned uid                - - - - - - - - - - - - -   x_uid                                                                                                 i_equal     -1                                                                                                   

   COND       verify production user still there                                 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call user validation                 yENV_user_data              'n'  , "root"       , &x_uid, NULL  , NULL  , NULL   , &x_qual, &x_log , &x_act , &x_grp , l, g       i_equal     0                                                                                                    
     echo     ...check returned uid                - - - - - - - - - - - - -   x_uid                                                                                                 i_equal     0                                                                                                    
     exec     call user validation                 yENV_user_data              'n'  , "member"     , &x_uid, NULL  , NULL  , NULL   , &x_qual, &x_log , &x_act , &x_grp , l, g       i_equal     0                                                                                                    
     echo     ...check returned uid                - - - - - - - - - - - - -   x_uid                                                                                                 i_equal     1000                                                                                                 

   COND       end the test                                                       - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     wrap up testing                      yENV__unit_end                                                                                                                    i_equal     0                                                                                                    



#23456789-12  123456789-123456789-123456789-12345  123456789-123456789-123456  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-123456789- 
#==(verb)===  ===========(description)===========  =====(function)===========  ========================(arguments)=================================================================  ==(test)==  ==========================(results)=================================================================  ========(var)======= 
SCRP    [ии]  (USER) verify user full interface                                  0s   full            yENV_user_full                                                               ((01.---))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
   local      create a name variable               - - - - - - - - - - - - -   char  x_name  [LEN_USER]  = "";                                                                                                                                                                                            
   local      create a uid variable                - - - - - - - - - - - - -   int   x_uid  = -1;                                                                                                                                                                                                         
   local      create a gid variable                - - - - - - - - - - - - -   int   x_gid  = -1;                                                                                                                                                                                                         
   local      create a path variable               - - - - - - - - - - - - -   char  x_dir   [LEN_HUND]  = "";                                                                                                                                                                                             
   local      create a shell variable              - - - - - - - - - - - - -   char  x_shl   [LEN_HUND]  = "";                                                                                                                                                                                             
   local      create a desc variable               - - - - - - - - - - - - -   char  hnd     [LEN_LABEL] = "";                                                                                                                                                                                            
   local      create a desc variable               - - - - - - - - - - - - -   char  qua     =  '-';                                                                                                                                                                                                      
   local      create a desc variable               - - - - - - - - - - - - -   char  log     =  '-';                                                                                                                                                                                                      
   local      create a desc variable               - - - - - - - - - - - - -   char  act     =  '-';                                                                                                                                                                                                      
   local      create a desc variable               - - - - - - - - - - - - -   char  grp     =    0;                                                                                                                                                                                                      
   local      create a desc variable               - - - - - - - - - - - - -   char  l       [LEN_HUND]  = "";                                                                                                                                                                                            
   local      create a desc variable               - - - - - - - - - - - - -   char  g       [LEN_HUND]  = "";                                                                                                                                                                                            

   COND       prepare for run                                                    - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     prepare for testing                  yENV__unit_quiet                                                                                                                  i_equal     0                                                                                                    

   COND       verify quick success                                               - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((02.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call user validation                 yENV_user_full              YENV_REG  , "member"   , x_name, &x_uid, &x_gid, x_dir , x_shl , hnd , &qua, &log, &act, &grp, l, g   i_equal     1                                                                                                    
     echo     ...check returned handler            - - - - - - - - - - - - -   hnd                                                                                                   w_equal     тnameТ                                                                                           

   COND  (0)  review output                                                      - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((02.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     echo     ...check returned name               - - - - - - - - - - - - -   x_name                                                                                                w_equal     тmemberТ                                                                                              
     echo     ...check returned uid                - - - - - - - - - - - - -   x_uid                                                                                                 i_equal     1000                                                                                                 
     echo     ...check returned gid                - - - - - - - - - - - - -   x_gid                                                                                                 i_equal     1000                                                                                                 
     echo     ...check returned dir                - - - - - - - - - - - - -   x_dir                                                                                                 w_equal     т/home/memberТ                                                                                           
     echo     ...check returned shell              - - - - - - - - - - - - -   x_shl                                                                                                 w_equal     т/bin/bashТ                                                                                         

   COND       verify finding current user                                        - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((02.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call user validation                 yENV_user_full              YENV_REG  , "@"        , x_name, &x_uid, &x_gid, x_dir , x_shl , hnd , &qua, &log, &act, &grp, l, g   i_equal     1                                                                                                    
     echo     ...check returned handler            - - - - - - - - - - - - -   hnd                                                                                                   w_equal     тdefaultТ                                                                                        

   COND  (2)  review output                                                      - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((02.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     echo     ...check returned name               - - - - - - - - - - - - -   x_name                                                                                                w_equal     тrootТ                                                                                                
     echo     ...check returned uid                - - - - - - - - - - - - -   x_uid                                                                                                 i_equal     0                                                                                                    
     echo     ...check returned gid                - - - - - - - - - - - - -   x_gid                                                                                                 i_equal     0                                                                                                    
     echo     ...check returned dir                - - - - - - - - - - - - -   x_dir                                                                                                 w_equal     т/rootТ                                                                                                  
     echo     ...check returned shell              - - - - - - - - - - - - -   x_shl                                                                                                 w_equal     т/bin/bashТ                                                                                         

   COND       verify switching users                                             - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((02.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     switch user                          yENV_user_switch            "member"                                                                                              i_equal     0                                                                                                    
     exec     call user validation                 yENV_user_full              YENV_REG  , "@"        , x_name, &x_uid, &x_gid, x_dir , x_shl , hnd , &qua, &log, &act, &grp, l, g   i_equal     1                                                                                                    
     echo     ...check returned handler            - - - - - - - - - - - - -   hnd                                                                                                   w_equal     тdefaultТ                                                                                        

   DITTO (0)  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((18.008))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       verify switching users back                                        - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((02.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     switch user                          yENV_user_switch            "root"                                                                                                i_equal     0                                                                                                    
     exec     call user validation                 yENV_user_full              YENV_REG  , "@"        , x_name, &x_uid, &x_gid, x_dir , x_shl , hnd , &qua, &log, &act, &grp, l, g   i_equal     1                                                                                                    
     echo     ...check returned handler            - - - - - - - - - - - - -   hnd                                                                                                   w_equal     тdefaultТ                                                                                        

   DITTO (2)  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((18.008))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       attempt with a missing user                                        - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((02.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call user validation                 yENV_user_full              YENV_REG  , "hank"     , x_name, &x_uid, &x_gid, x_dir , x_shl , hnd , &qua, &log, &act, &grp, l, g   i_lesser    0                                                                                                    
     echo     ...check returned handler            - - - - - - - - - - - - -   hnd                                                                                                   w_equal     тnameТ                                                                                           

   COND  (1)  review output                                                      - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((02.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     echo     ...check returned name               - - - - - - - - - - - - -   x_name                                                                                                w_equal     тТ                                                                                                    
     echo     ...check returned uid                - - - - - - - - - - - - -   x_uid                                                                                                 i_equal     -1                                                                                                   
     echo     ...check returned gid                - - - - - - - - - - - - -   x_gid                                                                                                 i_equal     -1                                                                                                   
     echo     ...check returned dir                - - - - - - - - - - - - -   x_dir                                                                                                 w_equal     тТ                                                                                                       
     echo     ...check returned shell              - - - - - - - - - - - - -   x_shl                                                                                                 w_equal     тТ                                                                                                  

   COND       verify quick success with uid                                      - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((02.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call user validation                 yENV_user_full              YENV_REG  , "1000"     , x_name, &x_uid, &x_gid, x_dir , x_shl , hnd , &qua, &log, &act, &grp, l, g   i_equal     1                                                                                                    
     echo     ...check returned handler            - - - - - - - - - - - - -   hnd                                                                                                   w_equal     тuidТ                                                                                            

   DITTO (0)  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((18.008))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       attempt with a missing uid                                         - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((02.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call user validation                 yENV_user_full              YENV_REG  , "9876"     , x_name, &x_uid, &x_gid, x_dir , x_shl , hnd , &qua, &log, &act, &grp, l, g   i_lesser    0                                                                                                    
     echo     ...check returned handler            - - - - - - - - - - - - -   hnd                                                                                                   w_equal     тuidТ                                                                                            

   DITTO (1)  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((18.008))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       verify finding new user                                            - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((02.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     make user                            yENV_user_add               "USR_some"           , 9876 , 'y'  , 'b'                                                              i_equal     0                                                                                                    
     exec     call user validation                 yENV_user_full              YENV_REG  , "9876"     , x_name, &x_uid, &x_gid, x_dir , x_shl , hnd , &qua, &log, &act, &grp, l, g   i_equal     1                                                                                                    
     echo     ...check returned uid                - - - - - - - - - - - - -   x_uid                                                                                                 i_equal     9876                                                                                                 
     echo     ...check returned gid                - - - - - - - - - - - - -   x_gid                                                                                                 i_equal     65534                                                                                                
     echo     ...check returned dir                - - - - - - - - - - - - -   x_dir                                                                                                 w_equal     т/home/USR_someТ                                                                                         
     echo     ...check returned shell              - - - - - - - - - - - - -   x_shl                                                                                                 w_equal     т/bin/bashТ                                                                                          

   COND       attempt finding a deleted user                                     - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((02.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     delete user                          yENV_user_del               "USR_some"                                                                                            i_equal     0                                                                                                    
     exec     call user validation                 yENV_user_full              YENV_REG  , "9876"     , x_name, &x_uid, &x_gid, x_dir , x_shl , hnd , &qua, &log, &act, &grp, l, g   i_lesser    0                                                                                                    

   DITTO (1)  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((18.008))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       verify ignoring user                                               - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((02.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call user validation                 yENV_user_full              YENV_REG  , "-"        , x_name, &x_uid, &x_gid, x_dir , x_shl , hnd , &qua, &log, &act, &grp, l, g   i_equal     0                                                                                                    
     echo     ...check returned handler            - - - - - - - - - - - - -   hnd                                                                                                   w_equal     тignoreТ                                                                                         

   DITTO (1)  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((18.008))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       end the test                                                       - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     wrap up testing                      yENV__unit_end                                                                                                                    i_equal     0                                                                                                    



#23456789-12  123456789-123456789-123456789-12345  123456789-123456789-123456  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-123456789- 
#==(verb)===  ===========(description)===========  =====(function)===========  ========================(arguments)=================================================================  ==(test)==  ==========================(results)=================================================================  ========(var)======= 
SCRP    [0a]  (USER) verify data access functions                                0s   access          yENV_user_count, yENV_user_by_cursor, yENV_user_by_text                      ((01.---))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       prepare for run                                                    - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     prepare for testing                  yENV__unit_quiet                                                                                                                  i_equal     0                                                                                                    

   COND       verify the total count                                             - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call count                           yENV_user_count                                                                                                                   i_equal     19                                                                                                   

   COND       verify by cursor forward                                           - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call head                            yENV_user_by_cursor         YDLST_HEAD                                                                                            w_equal     тroot          y  y  y      0      0  /root                           /bin/bash             10  ,(SELF),bin,daemon,sys,adm,disk,wheel,floppy,tape,video,      ,0,1,2,3,4,6,10,11,26,27,       ¤Т
     exec     call prev (boom)                     yENV_user_by_cursor         YDLST_PREV                                                                                            w_equal     т(n/a)Т
     exec     call next                            yENV_user_by_cursor         YDLST_NEXT                                                                                            w_equal     тbin           y  y  и      1      1  /bin                            /bin/false             3  ,(SELF),daemon,sys,                                           ,1,2,3,                         ¤Т
     exec     call next                            yENV_user_by_cursor         YDLST_NEXT                                                                                            w_equal     тdaemon        y  y  и      2      2  /sbin                           /bin/false             3  ,bin,(SELF),adm,                                              ,1,2,4,                         ¤Т
     exec     call current                         yENV_user_by_cursor         YDLST_CURR                                                                                            w_equal     тdaemon        y  y  и      2      2  /sbin                           /bin/false             3  ,bin,(SELF),adm,                                              ,1,2,4,                         ¤Т

   COND       attempt some defenses                                              - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call cursor (zero)                   yENV_user_by_cursor         0                                                                                                     w_equal     т(bad dir)Т
     exec     call cursor (bad dir)                yENV_user_by_cursor         '/'                                                                                                   w_equal     т(bad dir)Т

   COND       verify by cursor backward                                          - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call tail                            yENV_user_by_cursor         YDLST_TAIL                                                                                            w_equal     тmember        y  y  y   1000   1000  /home/member                    /bin/bash              0  .                                                             .                               ¤Т
     exec     call next (boom)                     yENV_user_by_cursor         YDLST_NEXT                                                                                            w_equal     т(n/a)Т
     exec     call prev                            yENV_user_by_cursor         YDLST_PREV                                                                                            w_equal     тntp           y  y  и    123    123  /dev/null                       /sbin/nologin          0  .                                                             .                               ¤Т
     exec     call prev                            yENV_user_by_cursor         YDLST_PREV                                                                                            w_equal     тsshd          y  y  и     22     22  /var/empty                      /sbin/nologin          0  .                                                             .                               ¤Т
     exec     call current                         yENV_user_by_cursor         YDLST_CURR                                                                                            w_equal     тsshd          y  y  и     22     22  /var/empty                      /sbin/nologin          0  .                                                             .                               ¤Т

   COND       verify by text options                                             - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call by text (NULL)                  yENV_user_by_text           NULL                                                                                                  w_equal     т(null)Т
     exec     call by name                         yENV_user_by_text           "member"                                                                                              w_equal     тmember        y  y  y   1000   1000  /home/member                    /bin/bash              0  .                                                             .                               ¤Т
     exec     call by text (empty)                 yENV_user_by_text           ""                                                                                                    w_equal     т(empty)Т
     exec     call by uid                          yENV_user_by_text           "22"                                                                                                  w_equal     тsshd          y  y  и     22     22  /var/empty                      /sbin/nologin          0  .                                                             .                               ¤Т
     exec     call by text (missing)               yENV_user_by_text           "jojo"                                                                                                w_equal     т(n/a)Т

   COND       end the test                                                       - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     wrap up testing                      yENV__unit_end                                                                                                                    i_equal     0                                                                                                    





