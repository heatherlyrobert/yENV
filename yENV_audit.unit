




#23456789-12  123456789-123456789-123456789-12345  123456789-123456789-123456  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-123456789- 
#==(verb)===  ===========(description)===========  =====(function)===========  ========================(arguments)=================================================================  ==(test)==  ==========================(results)=================================================================  ========(var)======= 
SCRP    [0a]  (AUDIT) verify expected file characteristics                       0s   expect          yenv_audit_expect                                                            ((01.---))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       prepare for run                                                    - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     prepare for testing                  yENV__unit_quiet                                                                                                                  i_equal     0                                                                                                    
     local    create working variable              - - - - - - - - - - - - -   char        x_owner  [LEN_USER]  = "";                                                                                                                                                                                     
     local    create working variable              - - - - - - - - - - - - -   char        x_group  [LEN_USER]  = "";                                                                                                                                                                                     
     local    create working variable              - - - - - - - - - - - - -   char        x_perms  [LEN_TERSE] = "";                                                                                                                                                                                     
     local    create working variable              - - - - - - - - - - - - -   int         x_uid, x_gid, x_prm;                                                                                                                                                                                           
     local    create working variable              - - - - - - - - - - - - -   char        x_disp   [LEN_LABEL] = "";                                                                                                                                                                                     
     code     prepare outputs                      - - - - - - - - - - - - -   yURG_msg_tmp (); yURG_msg_live ();  yURG_err_tmp ();  yURG_err_live ();                                                                                                                                                    

   COND  (0)  check clean and silent                                             - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     verify messages output               yENV_lines                  YURG_MSG                                                                                              i_equal     0                                                                                                    
     exec     ... review line                      yENV_peek                   YURG_MSG                      , 0                                                                     s_equal     (n/a)                                                                                                                                                 
     exec     verify errors output                 yENV_lines                  YURG_ERR                                                                                              i_equal     0                                                                                                    
     exec     ... review line                      yENV_peek                   YURG_ERR                      , 0                                                                     s_equal     (n/a)                                                                                                                                                 
     code     prepare outputs                      - - - - - - - - - - - - -   yURG_msg_tmp (); yURG_msg_live ();  yURG_err_tmp ();  yURG_err_live ();                                                                                                                                                    

   COND       verify just owner                                                  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     prepare inputs                       - - - - - - - - - - - - -   strcpy (x_owner, "root"     );  strcpy (x_group, "root"     );  strcpy (x_perms, "f_open"   );                                                                                                                             
     exec     call expect                          yenv_audit_expect           x_owner       , NULL          , NULL          , &x_uid    ,  NULL      , NULL     , NULL              i_equal     RC_POSITIVE                                                                                         
     echo     ... check owner                      - - - - - - - - - - - - -   x_owner                                                                                               w_equal     årootæ                                                                                                
     echo     ... check uid                        - - - - - - - - - - - - -   x_uid                                                                                                 i_equal     0                                                                                                     

   DITTO (0)  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((18.008))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       attempt without owner name                                         - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     prepare inputs                       - - - - - - - - - - - - -   strcpy (x_owner, "root"     );  strcpy (x_group, "root"     );  strcpy (x_perms, "f_open"   );                                                                                                                             
     exec     call expect                          yenv_audit_expect           NULL          , NULL          , NULL          , &x_uid    ,  NULL      , NULL     , NULL              i_equal     RC_POSITIVE                                                                                         
     echo     ... check owner                      - - - - - - - - - - - - -   x_owner                                                                                               w_equal     årootæ                                                                                                
     echo     ... check uid                        - - - - - - - - - - - - -   x_uid                                                                                                 i_equal     -1                                                                                                    

   DITTO (0)  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((18.008))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       attempt with bad owner                                             - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     prepare inputs                       - - - - - - - - - - - - -   strcpy (x_owner, "chaos"    );  strcpy (x_group, "root"     );  strcpy (x_perms, "f_open"   );                                                                                                                             
     exec     call expect                          yenv_audit_expect           x_owner       , NULL          , NULL          , &x_uid    ,  NULL      , NULL     , NULL              i_lesser    0                                                                                                   
     echo     ... check owner                      - - - - - - - - - - - - -   x_owner                                                                                               w_equal     åæ                                                                                                    
     echo     ... check uid                        - - - - - - - - - - - - -   x_uid                                                                                                 i_equal     -1                                                                                                    

   COND       check error                                                        - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     verify messages output               yENV_lines                  YURG_MSG                                                                                              i_equal     0                                                                                                    
     exec     ... review line                      yENV_peek                   YURG_MSG                      , 0                                                                     s_equal     (n/a)                                                                                                                                                 
     exec     verify errors output                 yENV_lines                  YURG_ERR                                                                                              i_equal     1                                                                                                    
     code     create error message                 - - - - - - - - - - - - -   strcpy (u_error, "  " BOLD_ERR "** FATAL, attempting to use illegal requested owner åchaosæ, uid -1" BOLD_OFF);                                                                                                                                         
     exec     ... review line                      yENV_peek                   YURG_ERR                      , 0                                                                     s_equal     [[ u_error ]]                                                                                        
     exec     ... review line                      yENV_peek                   YURG_ERR                      , 'Ö'                                                                   s_equal     (n/a)                                                                                                
     code     prepare outputs                      - - - - - - - - - - - - -   yURG_msg_tmp (); yURG_msg_live ();  yURG_err_tmp ();  yURG_err_live ();                                                                                                                                                    

   COND       attempt with blank owner                                           - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     prepare inputs                       - - - - - - - - - - - - -   strcpy (x_owner, ""         );  strcpy (x_group, "root"     );  strcpy (x_perms, "f_open"   );                                                                                                                             
     exec     call expect                          yenv_audit_expect           x_owner       , NULL          , NULL          , &x_uid    ,  NULL      , NULL     , NULL              i_equal     RC_POSITIVE                                                                                         
     echo     ... check owner                      - - - - - - - - - - - - -   x_owner                                                                                               w_equal     årootæ                                                                                                
     echo     ... check uid                        - - - - - - - - - - - - -   x_uid                                                                                                 i_equal     0                                                                                                     

   DITTO (0)  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((18.008))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       verify a different user                                            - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     prepare inputs                       - - - - - - - - - - - - -   strcpy (x_owner, "member"   );  strcpy (x_group, "root"     );  strcpy (x_perms, "f_open"   );                                                                                                                             
     exec     call expect                          yenv_audit_expect           x_owner       , NULL          , NULL          , &x_uid    ,  NULL      , NULL     , NULL              i_equal     RC_POSITIVE                                                                                         
     echo     ... check owner                      - - - - - - - - - - - - -   x_owner                                                                                               w_equal     åmemberæ                                                                                              
     echo     ... check uid                        - - - - - - - - - - - - -   x_uid                                                                                                 i_equal     1000                                                                                                  

   DITTO (0)  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((18.008))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       verify just group                                                  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     prepare inputs                       - - - - - - - - - - - - -   strcpy (x_owner, "root"     );  strcpy (x_group, "root"     );  strcpy (x_perms, "f_open"   );                                                                                                                             
     exec     call expect                          yenv_audit_expect           NULL          , x_group       , NULL          , NULL      ,  &x_gid    , NULL     , NULL              i_equal     RC_POSITIVE                                                                                         
     echo     ... check group                      - - - - - - - - - - - - -   x_group                                                                                               w_equal     årootæ                                                                                                
     echo     ... check gid                        - - - - - - - - - - - - -   x_gid                                                                                                 i_equal     0                                                                                                     

   DITTO (0)  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((18.008))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       attempt without group name                                         - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     prepare inputs                       - - - - - - - - - - - - -   strcpy (x_owner, "root"     );  strcpy (x_group, "root"     );  strcpy (x_perms, "f_open"   );                                                                                                                             
     exec     call expect                          yenv_audit_expect           NULL          , NULL          , NULL          , NULL      ,  &x_gid    , NULL     , NULL              i_equal     RC_POSITIVE                                                                                         
     echo     ... check group                      - - - - - - - - - - - - -   x_group                                                                                               w_equal     årootæ                                                                                                
     echo     ... check gid                        - - - - - - - - - - - - -   x_gid                                                                                                 i_equal     -1                                                                                                    

   DITTO (0)  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((18.008))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       attempt with bad group                                             - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     prepare inputs                       - - - - - - - - - - - - -   strcpy (x_owner, "root"     );  strcpy (x_group, "uppers"   );  strcpy (x_perms, "f_open"   );                                                                                                                             
     exec     call expect                          yenv_audit_expect           NULL          , x_group       , NULL          , NULL      ,  &x_gid    , NULL     , NULL              i_lesser    0                                                                                                   
     echo     ... check group                      - - - - - - - - - - - - -   x_group                                                                                               w_equal     åæ                                                                                                    
     echo     ... check gid                        - - - - - - - - - - - - -   x_gid                                                                                                 i_equal     -1                                                                                                    

   COND       check error                                                        - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     verify messages output               yENV_lines                  YURG_MSG                                                                                              i_equal     0                                                                                                    
     exec     ... review line                      yENV_peek                   YURG_MSG                      , 0                                                                     s_equal     (n/a)                                                                                                                                                 
     exec     verify errors output                 yENV_lines                  YURG_ERR                                                                                              i_equal     1                                                                                                    
     code     create error message                 - - - - - - - - - - - - -   strcpy (u_error, "  " BOLD_ERR "** FATAL, attempting to use illegal requested group åuppersæ, gid -1" BOLD_OFF);                                                                                                                                         
     exec     ... review line                      yENV_peek                   YURG_ERR                      , 0                                                                     s_equal     [[ u_error ]]                                                                                        
     exec     ... review line                      yENV_peek                   YURG_ERR                      , 'Ö'                                                                   s_equal     (n/a)                                                                                                
     code     prepare outputs                      - - - - - - - - - - - - -   yURG_msg_tmp (); yURG_msg_live ();  yURG_err_tmp ();  yURG_err_live ();                                                                                                                                                    

   COND       attempt with blank group                                           - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     prepare inputs                       - - - - - - - - - - - - -   strcpy (x_owner, "root"     );  strcpy (x_group, "root"     );  strcpy (x_perms, "f_open"   );                                                                                                                             
     exec     call expect                          yenv_audit_expect           NULL          , x_group       , NULL          , NULL      ,  &x_gid    , NULL     , NULL              i_equal     RC_POSITIVE                                                                                         
     echo     ... check group                      - - - - - - - - - - - - -   x_group                                                                                               w_equal     årootæ                                                                                                
     echo     ... check gid                        - - - - - - - - - - - - -   x_gid                                                                                                 i_equal     0                                                                                                     

   DITTO (0)  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((18.008))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       verify a different group                                           - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     prepare inputs                       - - - - - - - - - - - - -   strcpy (x_owner, "root"     );  strcpy (x_group, "users"    );  strcpy (x_perms, "f_open"   );                                                                                                                             
     exec     call expect                          yenv_audit_expect           NULL          , x_group       , NULL          , NULL      ,  &x_gid    , NULL     , NULL              i_equal     RC_POSITIVE                                                                                         
     echo     ... check group                      - - - - - - - - - - - - -   x_group                                                                                               w_equal     åusersæ                                                                                               
     echo     ... check gid                        - - - - - - - - - - - - -   x_gid                                                                                                 i_equal     100                                                                                                   

   DITTO (0)  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((18.008))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       verify just perms                                                  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     prepare inputs                       - - - - - - - - - - - - -   strcpy (x_owner, "root"     );  strcpy (x_group, "root"     );  strcpy (x_perms, "f_open"   );                                                                                                                             
     exec     call expect                          yenv_audit_expect           NULL          , NULL          , x_perms       , NULL      ,  NULL      , &x_prm   , x_disp            i_equal     RC_POSITIVE                                                                                         
     echo     ... check perms                      - - - - - - - - - - - - -   x_perms                                                                                               w_equal     åf_openæ                                                                                              
     echo     ... check prm                        - - - - - - - - - - - - -   x_prm                                                                                                 i_equal     0666                                                                                                  
     echo     ... check disp                       - - - - - - - - - - - - -   x_disp                                                                                                w_equal     årw-rw-rw-æ                                                                                             

   DITTO (0)  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((18.008))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       attempt without perms name                                         - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     prepare inputs                       - - - - - - - - - - - - -   strcpy (x_owner, "root"     );  strcpy (x_group, "root"     );  strcpy (x_perms, "f_open"   );                                                                                                                             
     exec     call expect                          yenv_audit_expect           NULL          , NULL          , NULL          , NULL      ,  NULL      , &x_prm   , x_disp            i_equal     RC_POSITIVE                                                                                         
     echo     ... check perms                      - - - - - - - - - - - - -   x_perms                                                                                               w_equal     åf_openæ                                                                                              
     echo     ... check prm                        - - - - - - - - - - - - -   x_prm                                                                                                 i_equal     -1                                                                                                    
     echo     ... check disp                       - - - - - - - - - - - - -   x_disp                                                                                                w_equal     åæ                                                                                                      

   DITTO (0)  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((18.008))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       attempt with bad perms                                             - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     prepare inputs                       - - - - - - - - - - - - -   strcpy (x_owner, "root"     );  strcpy (x_group, "root"     );  strcpy (x_perms, "f_OPEN"   );                                                                                                                             
     exec     call expect                          yenv_audit_expect           NULL          , NULL          , x_perms       , NULL      ,  NULL      , &x_prm   , x_disp            i_lesser    0                                                                                                   
     echo     ... check perms                      - - - - - - - - - - - - -   x_perms                                                                                               w_equal     åæ                                                                                                    
     echo     ... check prm                        - - - - - - - - - - - - -   x_prm                                                                                                 i_equal     -1                                                                                                    
     echo     ... check disp                       - - - - - - - - - - - - -   x_disp                                                                                                w_equal     åæ                                                                                                      

   COND       check error                                                        - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     verify messages output               yENV_lines                  YURG_MSG                                                                                              i_equal     0                                                                                                    
     exec     ... review line                      yENV_peek                   YURG_MSG                      , 0                                                                     s_equal     (n/a)                                                                                                                                                 
     exec     verify errors output                 yENV_lines                  YURG_ERR                                                                                              i_equal     1                                                                                                    
     code     create error message                 - - - - - - - - - - - - -   strcpy (u_error, "  " BOLD_ERR "** FATAL, attempting to use illegal requested perms åf_OPENæ, prm -1" BOLD_OFF);                                                                                                                                         
     exec     ... review line                      yENV_peek                   YURG_ERR                      , 0                                                                     s_equal     [[ u_error ]]                                                                                        
     exec     ... review line                      yENV_peek                   YURG_ERR                      , 'Ö'                                                                   s_equal     (n/a)                                                                                                
     code     prepare outputs                      - - - - - - - - - - - - -   yURG_msg_tmp (); yURG_msg_live ();  yURG_err_tmp ();  yURG_err_live ();                                                                                                                                                    

   COND       attempt with blank perms                                           - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     prepare inputs                       - - - - - - - - - - - - -   strcpy (x_owner, "root"     );  strcpy (x_group, "root"     );  strcpy (x_perms, ""         );                                                                                                                             
     exec     call expect                          yenv_audit_expect           NULL          , NULL          , x_perms       , NULL      ,  NULL      , &x_prm   , x_disp            i_equal     RC_POSITIVE                                                                                         
     echo     ... check perms                      - - - - - - - - - - - - -   x_perms                                                                                               w_equal     åf_tightæ                                                                                             
     echo     ... check prm                        - - - - - - - - - - - - -   x_prm                                                                                                 i_equal     0600                                                                                                  
     echo     ... check disp                       - - - - - - - - - - - - -   x_disp                                                                                                w_equal     årw-------æ                                                                                             

   DITTO (0)  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((18.008))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       verify a different perms                                           - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     prepare inputs                       - - - - - - - - - - - - -   strcpy (x_owner, "root"     );  strcpy (x_group, "root"     );  strcpy (x_perms, "r_only"   );                                                                                                                             
     exec     call expect                          yenv_audit_expect           NULL          , NULL          , x_perms       , NULL      ,  NULL      , &x_prm   , x_disp            i_equal     RC_POSITIVE                                                                                         
     echo     ... check perms                      - - - - - - - - - - - - -   x_perms                                                                                               w_equal     år_onlyæ                                                                                              
     echo     ... check prm                        - - - - - - - - - - - - -   x_prm                                                                                                 i_equal     0000                                                                                                  
     echo     ... check disp                       - - - - - - - - - - - - -   x_disp                                                                                                w_equal     å---------æ                                                                                             

   DITTO (0)  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((18.008))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       verify perms by octal                                              - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     prepare inputs                       - - - - - - - - - - - - -   strcpy (x_owner, "root"     );  strcpy (x_group, "root"     );  strcpy (x_perms, "0644"     );                                                                                                                             
     exec     call expect                          yenv_audit_expect           NULL          , NULL          , x_perms       , NULL      ,  NULL      , &x_prm   , x_disp            i_equal     RC_POSITIVE                                                                                         
     echo     ... check perms                      - - - - - - - - - - - - -   x_perms                                                                                               w_equal     åf_normalæ                                                                                            
     echo     ... check prm                        - - - - - - - - - - - - -   x_prm                                                                                                 i_equal     0644                                                                                                  
     echo     ... check disp                       - - - - - - - - - - - - -   x_disp                                                                                                w_equal     årw-r--r--æ                                                                                             

   DITTO (0)  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((18.008))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       verify just owner                                                  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     prepare inputs                       - - - - - - - - - - - - -   strcpy (x_owner, "member"   );  strcpy (x_group, "users"    );  strcpy (x_perms, "f_normal" );                                                                                                                             
     exec     call expect                          yenv_audit_expect           x_owner       , x_group       , x_perms       , &x_uid    ,  &x_gid    , &x_prm   , x_disp            i_equal     RC_POSITIVE                                                                                         
     echo     ... check owner                      - - - - - - - - - - - - -   x_owner                                                                                               w_equal     åmemberæ                                                                                              
     echo     ... check uid                        - - - - - - - - - - - - -   x_uid                                                                                                 i_equal     1000                                                                                                  
     echo     ... check group                      - - - - - - - - - - - - -   x_group                                                                                               w_equal     åusersæ                                                                                               
     echo     ... check gid                        - - - - - - - - - - - - -   x_gid                                                                                                 i_equal     100                                                                                                   
     echo     ... check perms                      - - - - - - - - - - - - -   x_perms                                                                                               w_equal     åf_normalæ                                                                                            
     echo     ... check prm                        - - - - - - - - - - - - -   x_prm                                                                                                 i_equal     0644                                                                                                  
     echo     ... check disp                       - - - - - - - - - - - - -   x_disp                                                                                                w_equal     årw-r--r--æ                                                                                             
   DITTO (0)  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((18.008))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       end the test                                                       - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     wrap up testing                      yENV__unit_end                                                                                                                    i_equal     0                                                                                                    



#23456789-12  123456789-123456789-123456789-12345  123456789-123456789-123456  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-123456789- 
#==(verb)===  ===========(description)===========  =====(function)===========  ========================(arguments)=================================================================  ==(test)==  ==========================(results)=================================================================  ========(var)======= 
SCRP    [0a]  (AUDIT) verify preparing file data                                 0s   prepare         yenv_audit_prepare                                                           ((01.---))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       prepare for run                                                    - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     prepare for testing                  yENV__unit_quiet                                                                                                                  i_equal     0                                                                                                    
     local    create working variable              - - - - - - - - - - - - -   char        x_full   [LEN_PATH]  = "";                                                                                                                                                                                     
     local    create working variable              - - - - - - - - - - - - -   char        x_tdesc  [LEN_TERSE] = "";                                                                                                                                                                                     
     local    create working variable              - - - - - - - - - - - - -   char        x_mode   [LEN_SHORT] = "";                                                                                                                                                                                     
     local    create working variable              - - - - - - - - - - - - -   char        x_note   [LEN_LABEL] = "";                                                                                                                                                                                     

   COND       verify quick success                                               - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call prepare                         yenv_audit_prepare          'r' , "/tmp"                   , "world.ctrl"       , 'w' , x_full  , x_tdesc , x_mode  , x_note      i_equal     RC_POSITIVE                                                                                         
     echo     ... check full                       - - - - - - - - - - - - -   x_full                                                                                                w_equal     å/tmp/world.ctrlæ                                                                                     
     echo     ... check type                       - - - - - - - - - - - - -   x_tdesc                                                                                               w_equal     åregularæ                                                                                             
     echo     ... check mode                       - - - - - - - - - - - - -   x_mode                                                                                                w_equal     åwtæ                                                                                                  
     echo     ... check note                       - - - - - - - - - - - - -   x_note                                                                                                w_equal     åwriting as textæ                                                                                                  

   COND       attempt with null path (defaulting)                                - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call prepare                         yenv_audit_prepare          'r' , NULL                     , "/tmp/world.ctrl"  , 'w' , x_full  , x_tdesc , x_mode  , x_note      i_lesser    0                                                                                                   
     echo     ... check full                       - - - - - - - - - - - - -   x_full                                                                                                w_equal     åæ                                                                                                    
     echo     ... check type                       - - - - - - - - - - - - -   x_tdesc                                                                                               w_equal     åæ                                                                                                    
     echo     ... check mode                       - - - - - - - - - - - - -   x_mode                                                                                                w_equal     åæ                                                                                                    
     echo     ... check note                       - - - - - - - - - - - - -   x_note                                                                                                w_equal     åæ                                                                                                                 

   COND       attempt with null file (defaulting)                                - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call prepare                         yenv_audit_prepare          'r' , "/tmp/world.ctrl"        , NULL               , 'w' , x_full  , x_tdesc , x_mode  , x_note      i_lesser    0                                                                                                   
     echo     ... check full                       - - - - - - - - - - - - -   x_full                                                                                                w_equal     åæ                                                                                                    
     echo     ... check type                       - - - - - - - - - - - - -   x_tdesc                                                                                               w_equal     åæ                                                                                                    
     echo     ... check mode                       - - - - - - - - - - - - -   x_mode                                                                                                w_equal     åæ                                                                                                    
     echo     ... check note                       - - - - - - - - - - - - -   x_note                                                                                                w_equal     åæ                                                                                                                 

   COND       verify slash at end of dir                                         - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call prepare                         yenv_audit_prepare          'r' , "/tmp/"                  , "world.ctrl"       , 'w' , x_full  , x_tdesc , x_mode  , x_note      i_equal     RC_POSITIVE                                                                                         
     echo     ... check full                       - - - - - - - - - - - - -   x_full                                                                                                w_equal     å/tmp/world.ctrlæ                                                                                     

   COND       verify emtpy file                                                  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call prepare                         yenv_audit_prepare          'r' , "/tmp/world.ctrl"        , ""                 , 'w' , x_full  , x_tdesc , x_mode  , x_note      i_equal     RC_POSITIVE                                                                                         
     echo     ... check full                       - - - - - - - - - - - - -   x_full                                                                                                w_equal     å/tmp/world.ctrlæ                                                                                     

   COND       verify emtpy directory                                             - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call prepare                         yenv_audit_prepare          'r' , ""                       , "/tmp/world.ctrl"  , 'w' , x_full  , x_tdesc , x_mode  , x_note      i_equal     RC_POSITIVE                                                                                         
     echo     ... check full                       - - - - - - - - - - - - -   x_full                                                                                                w_equal     å/tmp/world.ctrlæ                                                                                     

   COND       attempt with empty file and dir                                    - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call prepare                         yenv_audit_prepare          'r' , ""                       , NULL               , 'w' , x_full  , x_tdesc , x_mode  , x_note      i_lesser    0                                                                                                   
     echo     ... check full                       - - - - - - - - - - - - -   x_full                                                                                                w_equal     åæ                                                                                                    
     echo     ... check mode                       - - - - - - - - - - - - -   x_mode                                                                                                w_equal     åæ                                                                                                    
     echo     ... check note                       - - - - - - - - - - - - -   x_note                                                                                                w_equal     åæ                                                                                                                 

   COND       verify with other modes                                            - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call prepare                         yenv_audit_prepare          'r' , "/tmp"                   , "world.ctrl"       , 'W' , x_full  , x_tdesc , x_mode  , x_note      i_equal     RC_POSITIVE                                                                                         
     echo     ... check mode                       - - - - - - - - - - - - -   x_mode                                                                                                w_equal     åwbæ                                                                                                  
     echo     ... check note                       - - - - - - - - - - - - -   x_note                                                                                                w_equal     åwriting as binaryæ                                                                                                  
     exec     call prepare                         yenv_audit_prepare          'r' , "/tmp"                   , "world.ctrl"       , 'R' , x_full  , x_tdesc , x_mode  , x_note      i_equal     RC_POSITIVE                                                                                         
     echo     ... check mode                       - - - - - - - - - - - - -   x_mode                                                                                                w_equal     årbæ                                                                                                  
     echo     ... check note                       - - - - - - - - - - - - -   x_note                                                                                                w_equal     åreading as binaryæ                                                                                                  
     exec     call prepare                         yenv_audit_prepare          'r' , "/tmp"                   , "world.ctrl"       , 'r' , x_full  , x_tdesc , x_mode  , x_note      i_equal     RC_POSITIVE                                                                                         
     echo     ... check mode                       - - - - - - - - - - - - -   x_mode                                                                                                w_equal     årtæ                                                                                                  
     echo     ... check note                       - - - - - - - - - - - - -   x_note                                                                                                w_equal     åreading as textæ                                                                                                  
     exec     call prepare                         yenv_audit_prepare          'r' , "/tmp"                   , "world.ctrl"       , '-' , x_full  , x_tdesc , x_mode  , x_note      i_equal     RC_POSITIVE                                                                                         
     echo     ... check mode                       - - - - - - - - - - - - -   x_mode                                                                                                w_equal     å--æ                                                                                                  
     echo     ... check note                       - - - - - - - - - - - - -   x_note                                                                                                w_equal     åaudit-onlyæ                                                                                                       

   COND       attempt illegal modes                                              - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call prepare                         yenv_audit_prepare          'r' , "/tmp"                   , "world.ctrl"       , NULL, x_full  , x_tdesc , x_mode  , x_note      i_lesser    0                                                                                                   
     echo     ... check full                       - - - - - - - - - - - - -   x_full                                                                                                w_equal     åæ                                                                                                    
     echo     ... check mode                       - - - - - - - - - - - - -   x_mode                                                                                                w_equal     åæ                                                                                                    
     echo     ... check note                       - - - - - - - - - - - - -   x_note                                                                                                w_equal     åæ                                                                                                                 
     exec     call prepare                         yenv_audit_prepare          'r' , "/tmp"                   , "world.ctrl"       , ' ' , x_full  , x_tdesc , x_mode  , x_note      i_lesser    0                                                                                                   
     echo     ... check full                       - - - - - - - - - - - - -   x_full                                                                                                w_equal     åæ                                                                                                    
     echo     ... check mode                       - - - - - - - - - - - - -   x_mode                                                                                                w_equal     åæ                                                                                                    
     echo     ... check note                       - - - - - - - - - - - - -   x_note                                                                                                w_equal     åæ                                                                                                                 
     exec     call prepare                         yenv_audit_prepare          'r' , "/tmp"                   , "world.ctrl"       , '?' , x_full  , x_tdesc , x_mode  , x_note      i_lesser    0                                                                                                   
     echo     ... check full                       - - - - - - - - - - - - -   x_full                                                                                                w_equal     åæ                                                                                                    
     echo     ... check mode                       - - - - - - - - - - - - -   x_mode                                                                                                w_equal     åæ                                                                                                    
     echo     ... check note                       - - - - - - - - - - - - -   x_note                                                                                                w_equal     åæ                                                                                                                 

   COND       verify with missing returns                                        - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call prepare                         yenv_audit_prepare          'r' , "/tempest"               , "world.ctrl"       , 'R' , NULL    , x_tdesc , x_mode  , x_note      i_equal     RC_POSITIVE                                                                                         
     echo     ... check mode                       - - - - - - - - - - - - -   x_mode                                                                                                w_equal     årbæ                                                                                                  
     echo     ... check type                       - - - - - - - - - - - - -   x_tdesc                                                                                               w_equal     åregularæ                                                                                             
     echo     ... check note                       - - - - - - - - - - - - -   x_note                                                                                                w_equal     åreading as binaryæ                                                                                                  
     exec     call prepare                         yenv_audit_prepare          'r' , "/tempest"               , "world.ctrl"       , 'W' , x_full  , NULL    , x_mode  , x_note      i_equal     RC_POSITIVE                                                                                         
     echo     ... check full                       - - - - - - - - - - - - -   x_full                                                                                                w_equal     å/tempest/world.ctrlæ                                                                                     
     echo     ... check mode                       - - - - - - - - - - - - -   x_mode                                                                                                w_equal     åwbæ                                                                                                  
     echo     ... check note                       - - - - - - - - - - - - -   x_note                                                                                                w_equal     åwriting as binaryæ                                                                                                  
     exec     call prepare                         yenv_audit_prepare          'r' , "/tempest"               , "world.ctrl"       , 'W' , x_full  , x_tdesc , NULL    , x_note      i_equal     RC_POSITIVE                                                                                         
     echo     ... check full                       - - - - - - - - - - - - -   x_full                                                                                                w_equal     å/tempest/world.ctrlæ                                                                                     
     echo     ... check type                       - - - - - - - - - - - - -   x_tdesc                                                                                               w_equal     åregularæ                                                                                             
     echo     ... check note                       - - - - - - - - - - - - -   x_note                                                                                                w_equal     åwriting as binaryæ                                                                                                  
     exec     call prepare                         yenv_audit_prepare          'r' , "/tempest"               , "world.ctrl"       , 'w' , x_full  , x_tdesc , x_mode  , NULL        i_equal     RC_POSITIVE                                                                                         
     echo     ... check full                       - - - - - - - - - - - - -   x_full                                                                                                w_equal     å/tempest/world.ctrlæ                                                                                     
     echo     ... check type                       - - - - - - - - - - - - -   x_tdesc                                                                                               w_equal     åregularæ                                                                                             
     echo     ... check mode                       - - - - - - - - - - - - -   x_mode                                                                                                w_equal     åwtæ                                                                                                  

   COND       end the test                                                       - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     wrap up testing                      yENV__unit_end                                                                                                                    i_equal     0                                                                                                    



#23456789-12  123456789-123456789-123456789-12345  123456789-123456789-123456  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-123456789- 
#==(verb)===  ===========(description)===========  =====(function)===========  ========================(arguments)=================================================================  ==(test)==  ==========================(results)=================================================================  ========(var)======= 
SCRP    [0a]  (AUDIT) verify entry typing                                        0s   typing          yenv_audit_typing                                                            ((01.---))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       prepare for run                                                    - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     prepare for testing                  yENV__unit_quiet                                                                                                                  i_equal     0                                                                                                    

   COND  (0)  reset messages                                                     - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     prepare outputs                      - - - - - - - - - - - - -   yURG_msg_tmp (); yURG_msg_live ();  yURG_err_tmp ();  yURG_err_live ();                                                                                                                                                    

   COND       verify quick success                                               - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call typing                          yenv_audit_typing           'r' , "regular"  , 'r' , "regular"                                                                    i_equal     RC_ACK                                                                                              

   COND       check clean pass                                                   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     verify messages output               yENV_lines                  YURG_MSG                                                                                              i_equal     1                                                                                                    
     exec     ... review line                      yENV_peek                   YURG_MSG                      , 0                                                                     s_equal     ¬¬-- regular (r) entry existance confirmed, AND not a symlink/hardlink                                     
     exec     ... review line                      yENV_peek                   YURG_MSG                      , 'Ö'                                                                   s_equal     (n/a)                                                                                                
     exec     verify errors output                 yENV_lines                  YURG_ERR                                                                                              i_equal     0                                                                                                    
     exec     ... review line                      yENV_peek                   YURG_ERR                      , 0                                                                     s_equal     (n/a)                                                                                                                                                 

   DITTO (0)  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((18.008))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       attempt with a non-existant                                        - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call typing                          yenv_audit_typing           'r' , "regular"  , '-' , "non-exist"                                                                  i_equal     RC_FATAL                                                                                            

   COND       check clean pass                                                   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     verify messages output               yENV_lines                  YURG_MSG                                                                                              i_equal     0                                                                                                    
     exec     ... review line                      yENV_peek                   YURG_MSG                      , 0                                                                     s_equal     (n/a)                                                                                                
     exec     verify errors output                 yENV_lines                  YURG_ERR                                                                                              i_equal     1                                                                                                    
     code     create error message                 - - - - - - - - - - - - -   strcpy (u_error, "  " BOLD_ERR "** FATAL, regular (r) entry does not exist, AND not in FORCE mode" BOLD_OFF);                                                                                                                                         
     exec     ... review line                      yENV_peek                   YURG_ERR                      , 0                                                                     s_equal     [[ u_error ]]                                                                                        
     exec     ... review line                      yENV_peek                   YURG_ERR                      , 'Ö'                                                                   s_equal     (n/a)                                                                                                                                                 

   DITTO (0)  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((18.008))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       verify both are missing                                            - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call typing                          yenv_audit_typing           '-' , "non-exist", '-' , "non-exist"                                                                  i_equal     RC_POSITIVE                                                                                         

   COND       check clean pass                                                   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     verify messages output               yENV_lines                  YURG_MSG                                                                                              i_equal     1                                                                                                    
     exec     ... review line                      yENV_peek                   YURG_MSG                      , 0                                                                     s_equal     ¬¬-- non-existance of filesystem entry confirmed                                                     
     exec     ... review line                      yENV_peek                   YURG_MSG                      , 'Ö'                                                                   s_equal     (n/a)                                                                                                
     exec     verify errors output                 yENV_lines                  YURG_ERR                                                                                              i_equal     0                                                                                                    
     exec     ... review line                      yENV_peek                   YURG_ERR                      , 0                                                                     s_equal     (n/a)                                                                                                                                                 

   DITTO (0)  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((18.008))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       attempt with regular file as symlink                               - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call typing                          yenv_audit_typing           'r' , "regular"  , 's' , "symlink"                                                                    i_equal     RC_FATAL                                                                                            

   COND       check clean pass                                                   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     verify messages output               yENV_lines                  YURG_MSG                                                                                              i_equal     0                                                                                                    
     exec     ... review line                      yENV_peek                   YURG_MSG                      , 0                                                                     s_equal     (n/a)                                                                                                
     exec     verify errors output                 yENV_lines                  YURG_ERR                                                                                              i_equal     1                                                                                                    
     code     create error message                 - - - - - - - - - - - - -   strcpy (u_error, "  " BOLD_ERR "** FATAL, wanted regular (r) entry ACTUALLY refers to a symlink (s)" BOLD_OFF);                                                                                                                                         
     exec     ... review line                      yENV_peek                   YURG_ERR                      , 0                                                                     s_equal     [[ u_error ]]                                                                                        
     exec     ... review line                      yENV_peek                   YURG_ERR                      , 'Ö'                                                                   s_equal     (n/a)                                                                                                                                                 

   DITTO (0)  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((18.008))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       attempt with symlink as a directory                                - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call typing                          yenv_audit_typing           's' , "symlink"  , 'd' , "directory"                                                                  i_equal     RC_FATAL                                                                                            

   COND       check clean pass                                                   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     verify messages output               yENV_lines                  YURG_MSG                                                                                              i_equal     0                                                                                                    
     exec     ... review line                      yENV_peek                   YURG_MSG                      , 0                                                                     s_equal     (n/a)                                                                                                
     exec     verify errors output                 yENV_lines                  YURG_ERR                                                                                              i_equal     1                                                                                                    
     code     create error message                 - - - - - - - - - - - - -   strcpy (u_error, "  " BOLD_ERR "** FATAL, wanted symlink (s) entry ACTUALLY refers to a directory (d)" BOLD_OFF);                                                                                                                                         
     exec     ... review line                      yENV_peek                   YURG_ERR                      , 0                                                                     s_equal     [[ u_error ]]                                                                                        
     exec     ... review line                      yENV_peek                   YURG_ERR                      , 'Ö'                                                                   s_equal     (n/a)                                                                                                                                                 

   DITTO (0)  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((18.008))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       end the test                                                       - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     wrap up testing                      yENV__unit_end                                                                                                                    i_equal     0                                                                                                    



#23456789-12  123456789-123456789-123456789-12345  123456789-123456789-123456  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-123456789- 
#==(verb)===  ===========(description)===========  =====(function)===========  ========================(arguments)=================================================================  ==(test)==  ==========================(results)=================================================================  ========(var)======= 
SCRP    [0a]  (AUDIT) verify actual file characteristics                         0s   actual          yenv_audit_actual                                                            ((01.---))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       prepare for run                                                    - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     prepare for testing                  yENV__unit_quiet                                                                                                                  i_equal     0                                                                                                    
     local    create working variable              - - - - - - - - - - - - -   char        x_full   [LEN_PATH]  = "/tmp/testing.txt";                                                                                                                                                                     

   COND  (0)  reset messages                                                     - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     prepare outputs                      - - - - - - - - - - - - -   yURG_msg_tmp (); yURG_msg_live ();  yURG_err_tmp ();  yURG_err_live ();                                                                                                                                                    

   COND       verify quick success (no force/fix)                                - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     create testing file                  yENV_touch                  x_full    , "root"    , "root"    , "0600"                                                            c_equal     'r'                                                                                                  
     exec     ... check on file                    yENV_detail_unit            x_full                                                                                                s_equal     /tmp/testing.txt                               r  root        root        rw-------  ´                
     exec     call actual                          yenv_audit_actual           x_full, 'r' , "regular" , "root"  , "root"  , "f_tight"  ,    0,    0, 0600, "rw-------", '-' , '-'   i_equal     RC_POSITIVE                                                                                         
     exec     ... check on file                    yENV_detail_unit            x_full                                                                                                s_equal     /tmp/testing.txt                               r  root        root        rw-------  ´                
     exec     remove testing file                  yENV_rm                     x_full                                                                                                c_equal     '-'                                                                                                  

   COND       check clean pass                                                   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     verify messages output               yENV_lines                  YURG_MSG                                                                                              i_equal     3                                                                                                    
     exec     ... review line                      yENV_peek                   YURG_MSG                      , 0                                                                     s_equal     ¬¬-- regular (r) entry existance confirmed, AND not a symlink/hardlink                                                                                                                               
     exec     ... review line                      yENV_peek                   YURG_MSG                      , 'Ö'                                                                   s_equal     ¬¬-- ownership confirmed, owned by årootæ (0) and in group årootæ (0)                                                                                                                              
     exec     ... review line                      yENV_peek                   YURG_MSG                      , 'Ö'                                                                   s_equal     ¬¬-- permissions confirmed, åf_tightæ, 0600, disp årw-------æ                                                                                                
     exec     ... review line                      yENV_peek                   YURG_MSG                      , 'Ö'                                                                   s_equal     (n/a)                                                                                                                                                 
     exec     verify errors output                 yENV_lines                  YURG_ERR                                                                                              i_equal     0                                                                                                    
     exec     ... review line                      yENV_peek                   YURG_ERR                      , 0                                                                     s_equal     (n/a)                                                                                                                                                 

   DITTO (0)  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((18.008))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       attempt with a missing file (no force/fix)                         - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     ... check on file                    yENV_detail_unit            x_full                                                                                                s_equal     /tmp/testing.txt                               -  ·           ·           ·          ´                
     exec     call actual                          yenv_audit_actual           x_full, 'r' , "regular" , "root"  , "root"  , "f_tight"  ,    0,    0, 0600, "rw-------", '-' , '-'   i_lesser    0                                                                                                   
     exec     ... check on file                    yENV_detail_unit            x_full                                                                                                s_equal     /tmp/testing.txt                               -  ·           ·           ·          ´                

   COND       check results                                                      - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     verify messages output               yENV_lines                  YURG_MSG                                                                                              i_equal     0                                                                                                    
     exec     ... review line                      yENV_peek                   YURG_MSG                      , 0                                                                     s_equal     (n/a)                                                                                                                                                 
     exec     verify errors output                 yENV_lines                  YURG_ERR                                                                                              i_equal     1                                                                                                    
     code     create error message                 - - - - - - - - - - - - -   strcpy (u_error, "  " BOLD_ERR "** FATAL, regular (r) entry does not exist, AND not in FORCE mode" BOLD_OFF);                                                                                                                                         
     exec     ... review line                      yENV_peek                   YURG_ERR                      , 0                                                                     s_equal     [[ u_error ]]                                                                                        
     exec     ... review line                      yENV_peek                   YURG_ERR                      , 'Ö'                                                                   s_equal     (n/a)                                                                                                

   DITTO (0)  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((18.008))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       attempt missing file in fix mode (no force)                        - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     ... check on file                    yENV_detail_unit            x_full                                                                                                s_equal     /tmp/testing.txt                               -  ·           ·           ·          ´                
     exec     call actual                          yenv_audit_actual           x_full, 'r' , "regular" , "root"  , "root"  , "f_tight"  ,    0,    0, 0600, "rw-------", '-' , 'y'   i_lesser    0                                                                                                   
     exec     ... check on file                    yENV_detail_unit            x_full                                                                                                s_equal     /tmp/testing.txt                               -  ·           ·           ·          ´                
     exec     remove testing file                  yENV_rm                     x_full                                                                                                c_equal     '-'                                                                                                  

   COND       check results                                                      - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     verify messages output               yENV_lines                  YURG_MSG                                                                                              i_equal     0                                                                                                    
     exec     ... review line                      yENV_peek                   YURG_MSG                      , 0                                                                     s_equal     (n/a)                                                                                                                                                 
     exec     verify errors output                 yENV_lines                  YURG_ERR                                                                                              i_equal     2                                                                                                    
     code     create error message                 - - - - - - - - - - - - -   strcpy (u_error, "  " BOLD_YEL "** warning, troubles with entry existance (so everything)" BOLD_OFF);                                                                                                                                         
     exec     ... review line                      yENV_peek                   YURG_ERR                      , 0                                                                     s_equal     [[ u_error ]]                                                                                        
     code     create error message                 - - - - - - - - - - - - -   strcpy (u_error, "  " BOLD_ERR "** FATAL, file does not exist, and not in FORCE mode" BOLD_OFF);                                                                                                                                         
     exec     ... review line                      yENV_peek                   YURG_ERR                      , 'Ö'                                                                   s_equal     [[ u_error ]]                                                                                        
     exec     ... review line                      yENV_peek                   YURG_ERR                      , 'Ö'                                                                   s_equal     (n/a)                                                                                                

   DITTO (0)  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((18.008))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       verify missing file in force mode                                  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     ... check on file                    yENV_detail_unit            x_full                                                                                                s_equal     /tmp/testing.txt                               -  ·           ·           ·          ´                
     exec     call actual                          yenv_audit_actual           x_full, 'r' , "regular" , "root"  , "root"  , "f_tight"  ,    0,    0, 0600, "rw-------", 'y' , '-'   i_equal     RC_REPAIR                                                                                           
     exec     ... check on file                    yENV_detail_unit            x_full                                                                                                s_equal     /tmp/testing.txt                               r  root        root        rw-------  ´                
     exec     remove testing file                  yENV_rm                     x_full                                                                                                c_equal     '-'                                                                                                  

   COND       check clean pass                                                   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     verify messages output               yENV_lines                  YURG_MSG                                                                                              i_equal     4                                                                                                    
     exec     ... review line                      yENV_peek                   YURG_MSG                      , 0                                                                     s_equal     ¬¬-- system called in FORCE mode, so file created                                                                                                                        
     exec     ... review line                      yENV_peek                   YURG_MSG                      , 'Ö'                                                                   s_equal     ¬¬-- regular (r) entry existance confirmed, AND not a symlink/hardlink                                                                                                                      
     exec     ... review line                      yENV_peek                   YURG_MSG                      , 'Ö'                                                                   s_equal     ¬¬-- ownership confirmed, owned by årootæ (0) and in group årootæ (0)                                                                                                                              
     exec     ... review line                      yENV_peek                   YURG_MSG                      , 'Ö'                                                                   s_equal     ¬¬-- permissions confirmed, åf_tightæ, 0600, disp årw-------æ                                                                                                
     exec     ... review line                      yENV_peek                   YURG_MSG                      , 'Ö'                                                                   s_equal     (n/a)                                                                                                                                                 
     exec     verify errors output                 yENV_lines                  YURG_ERR                                                                                              i_equal     1                                                                                                    
     code     create error message                 - - - - - - - - - - - - -   strcpy (u_error, "  " BOLD_YEL "** warning, troubles with entry existance (so everything)" BOLD_OFF);                                                                                                                                         
     exec     ... review line                      yENV_peek                   YURG_ERR                      , 0                                                                     s_equal     [[ u_error ]]                                                                                        
     exec     ... review line                      yENV_peek                   YURG_ERR                      , 'Ö'                                                                   s_equal     (n/a)                                                                                                

   DITTO (0)  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((18.008))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       attempt bad ownership (no fix)                                     - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     create testing file                  yENV_touch                  x_full    , "member"  , "root"    , "0600"                                                            c_equal     'r'                                                                                                  
     exec     ... check on file                    yENV_detail_unit            x_full                                                                                                s_equal     /tmp/testing.txt                               r  member      root        rw-------  ´                
     exec     call actual                          yenv_audit_actual           x_full, 'r' , "regular" , "root"  , "root"  , "f_tight"  ,    0,    0, 0600, "rw-------", '-' , '-'   i_lesser    0                                                                                                   
     exec     ... check on file                    yENV_detail_unit            x_full                                                                                                s_equal     /tmp/testing.txt                               r  member      root        rw-------  ´                

   COND       check output                                                       - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     verify messages output               yENV_lines                  YURG_MSG                                                                                              i_equal     1                                                                                                    
     exec     ... review line                      yENV_peek                   YURG_MSG                      , 0                                                                     s_equal     ¬¬-- regular (r) entry existance confirmed, AND not a symlink/hardlink                                                                                                                      
     exec     ... review line                      yENV_peek                   YURG_MSG                      , 'Ö'                                                                   s_equal     (n/a)                                                                                                                                                 
     exec     verify errors output                 yENV_lines                  YURG_ERR                                                                                              i_equal     1                                                                                                    
     code     create error message                 - - - - - - - - - - - - -   strcpy (u_error, "  " BOLD_ERR "** FATAL, owned by åmemberæ (1000); BUT expected årootæ (0)" BOLD_OFF);                                                                                                                                         
     exec     ... review line                      yENV_peek                   YURG_ERR                      , 0                                                                     s_equal     [[ u_error ]]                                                                                        
     exec     ... review line                      yENV_peek                   YURG_ERR                      , 'Ö'                                                                   s_equal     (n/a)                                                                                                

   DITTO (0)  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((18.008))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       verify bad ownership with fix                                      - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     ... check on file                    yENV_detail_unit            x_full                                                                                                s_equal     /tmp/testing.txt                               r  member      root        rw-------  ´                
     exec     call actual                          yenv_audit_actual           x_full, 'r' , "regular" , "root"  , "root"  , "f_tight"  ,    0,    0, 0600, "rw-------", '-' , 'y'   i_equal     RC_REPAIR                                                                                           
     exec     ... check on file                    yENV_detail_unit            x_full                                                                                                s_equal     /tmp/testing.txt                               r  root        root        rw-------  ´                
     exec     remove testing file                  yENV_rm                     x_full                                                                                                c_equal     '-'                                                                                                  

   COND       check output                                                       - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     verify messages output               yENV_lines                  YURG_MSG                                                                                              i_equal     4                                                                                                    
     exec     ... review line                      yENV_peek                   YURG_MSG                      , 0                                                                     s_equal     ¬¬-- system called in FIX mode, so file updated                                                                                                                        
     exec     ... review line                      yENV_peek                   YURG_MSG                      , 'Ö'                                                                   s_equal     ¬¬-- regular (r) entry existance confirmed, AND not a symlink/hardlink                                                                                                                      
     exec     ... review line                      yENV_peek                   YURG_MSG                      , 'Ö'                                                                   s_equal     ¬¬-- ownership confirmed, owned by årootæ (0) and in group årootæ (0)                                                                                                                              
     exec     ... review line                      yENV_peek                   YURG_MSG                      , 'Ö'                                                                   s_equal     ¬¬-- permissions confirmed, åf_tightæ, 0600, disp årw-------æ                                                                                                
     exec     ... review line                      yENV_peek                   YURG_MSG                      , 'Ö'                                                                   s_equal     (n/a)                                                                                                                                                 
     exec     verify errors output                 yENV_lines                  YURG_ERR                                                                                              i_equal     1                                                                                                    
     code     create error message                 - - - - - - - - - - - - -   strcpy (u_error, "  " BOLD_YEL "** warning, troubles with entry owner" BOLD_OFF);                                                                                                                                         
     exec     ... review line                      yENV_peek                   YURG_ERR                      , 0                                                                     s_equal     [[ u_error ]]                                                                                        
     exec     ... review line                      yENV_peek                   YURG_ERR                      , 'Ö'                                                                   s_equal     (n/a)                                                                                                

   DITTO (0)  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((18.008))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       attempt bad group (no fix)                                         - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     create testing file                  yENV_touch                  x_full    , "root"    , "users"   , "0600"                                                            c_equal     'r'                                                                                                  
     exec     ... check on file                    yENV_detail_unit            x_full                                                                                                s_equal     /tmp/testing.txt                               r  root        users       rw-------  ´                
     exec     call actual                          yenv_audit_actual           x_full, 'r' , "regular" , "root"  , "root"  , "f_tight"  ,    0,    0, 0600, "rw-------", '-' , '-'   i_lesser    0                                                                                                   
     exec     ... check on file                    yENV_detail_unit            x_full                                                                                                s_equal     /tmp/testing.txt                               r  root        users       rw-------  ´                

   COND       check output                                                       - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     verify messages output               yENV_lines                  YURG_MSG                                                                                              i_equal     1                                                                                                    
     exec     ... review line                      yENV_peek                   YURG_MSG                      , 0                                                                     s_equal     ¬¬-- regular (r) entry existance confirmed, AND not a symlink/hardlink                                                                                                                      
     exec     ... review line                      yENV_peek                   YURG_MSG                      , 'Ö'                                                                   s_equal     (n/a)                                                                                                                                                 
     exec     verify errors output                 yENV_lines                  YURG_ERR                                                                                              i_equal     1                                                                                                    
     code     create error message                 - - - - - - - - - - - - -   strcpy (u_error, "  " BOLD_ERR "** FATAL, grouped in åusersæ (100); BUT expected årootæ (0)" BOLD_OFF);                                                                                                                                         
     exec     ... review line                      yENV_peek                   YURG_ERR                      , 0                                                                     s_equal     [[ u_error ]]                                                                                        
     exec     ... review line                      yENV_peek                   YURG_ERR                      , 'Ö'                                                                   s_equal     (n/a)                                                                                                

   DITTO (0)  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((18.008))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       verify bad group with fix                                          - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     ... check on file                    yENV_detail_unit            x_full                                                                                                s_equal     /tmp/testing.txt                               r  root        users       rw-------  ´                
     exec     call actual                          yenv_audit_actual           x_full, 'r' , "regular" , "root"  , "root"  , "f_tight"  ,    0,    0, 0600, "rw-------", '-' , 'y'   i_equal     RC_REPAIR                                                                                           
     exec     ... check on file                    yENV_detail_unit            x_full                                                                                                s_equal     /tmp/testing.txt                               r  root        root        rw-------  ´                
     exec     remove testing file                  yENV_rm                     x_full                                                                                                c_equal     '-'                                                                                                  

   COND       check output                                                       - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     verify messages output               yENV_lines                  YURG_MSG                                                                                              i_equal     4                                                                                                    
     exec     ... review line                      yENV_peek                   YURG_MSG                      , 0                                                                     s_equal     ¬¬-- system called in FIX mode, so file updated                                                                                                                        
     exec     ... review line                      yENV_peek                   YURG_MSG                      , 'Ö'                                                                   s_equal     ¬¬-- regular (r) entry existance confirmed, AND not a symlink/hardlink                                                                                                                      
     exec     ... review line                      yENV_peek                   YURG_MSG                      , 'Ö'                                                                   s_equal     ¬¬-- ownership confirmed, owned by årootæ (0) and in group årootæ (0)                                                                                                                              
     exec     ... review line                      yENV_peek                   YURG_MSG                      , 'Ö'                                                                   s_equal     ¬¬-- permissions confirmed, åf_tightæ, 0600, disp årw-------æ                                                                                                
     exec     ... review line                      yENV_peek                   YURG_MSG                      , 'Ö'                                                                   s_equal     (n/a)                                                                                                                                                 
     exec     verify errors output                 yENV_lines                  YURG_ERR                                                                                              i_equal     1                                                                                                    
     code     create error message                 - - - - - - - - - - - - -   strcpy (u_error, "  " BOLD_YEL "** warning, troubles with entry group" BOLD_OFF);                                                                                                                                         
     exec     ... review line                      yENV_peek                   YURG_ERR                      , 0                                                                     s_equal     [[ u_error ]]                                                                                        
     exec     ... review line                      yENV_peek                   YURG_ERR                      , 'Ö'                                                                   s_equal     (n/a)                                                                                                

   DITTO (0)  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((18.008))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       attempt bad perms (no fix)                                         - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     create testing file                  yENV_touch                  x_full    , "root"    , "root"    , "0644"                                                            c_equal     'r'                                                                                                  
     exec     ... check on file                    yENV_detail_unit            x_full                                                                                                s_equal     /tmp/testing.txt                               r  root        root        rw-r--r--  ´                
     exec     call actual                          yenv_audit_actual           x_full, 'r' , "regular" , "root"  , "root"  , "f_tight"  ,    0,    0, 0600, "rw-------", '-' , '-'   i_lesser    0                                                                                                   
     exec     ... check on file                    yENV_detail_unit            x_full                                                                                                s_equal     /tmp/testing.txt                               r  root        root        rw-r--r--  ´                

   COND       check output                                                       - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     verify messages output               yENV_lines                  YURG_MSG                                                                                              i_equal     2                                                                                                    
     exec     ... review line                      yENV_peek                   YURG_MSG                      , 0                                                                     s_equal     ¬¬-- regular (r) entry existance confirmed, AND not a symlink/hardlink                                                                                                                      
     exec     ... review line                      yENV_peek                   YURG_MSG                      , 'Ö'                                                                   s_equal     ¬¬-- ownership confirmed, owned by årootæ (0) and in group årootæ (0)                                                                                                                              
     exec     ... review line                      yENV_peek                   YURG_MSG                      , 'Ö'                                                                   s_equal     (n/a)                                                                                                                                                 
     exec     verify errors output                 yENV_lines                  YURG_ERR                                                                                              i_equal     1                                                                                                    
     code     create error message                 - - - - - - - - - - - - -   strcpy (u_error, "  " BOLD_ERR "** FATAL, permissions åf_normalæ, 0644, disp årw-r--r--æ; BUT expected åf_tightæ, 0600, disp årw-------æ" BOLD_OFF);                                                                                                                                         
     exec     ... review line                      yENV_peek                   YURG_ERR                      , 0                                                                     s_equal     [[ u_error ]]                                                                                        
     exec     ... review line                      yENV_peek                   YURG_ERR                      , 'Ö'                                                                   s_equal     (n/a)                                                                                                

   DITTO (0)  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((18.008))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       verify bad prems with fix                                          - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     ... check on file                    yENV_detail_unit            x_full                                                                                                s_equal     /tmp/testing.txt                               r  root        root        rw-r--r--  ´                
     exec     call actual                          yenv_audit_actual           x_full, 'r' , "regular" , "root"  , "root"  , "f_tight"  ,    0,    0, 0600, "rw-------", '-' , 'y'   i_equal     RC_REPAIR                                                                                           
     exec     ... check on file                    yENV_detail_unit            x_full                                                                                                s_equal     /tmp/testing.txt                               r  root        root        rw-------  ´                
     exec     remove testing file                  yENV_rm                     x_full                                                                                                c_equal     '-'                                                                                                  

   COND       check output                                                       - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     verify messages output               yENV_lines                  YURG_MSG                                                                                              i_equal     4                                                                                                    
     exec     ... review line                      yENV_peek                   YURG_MSG                      , 0                                                                     s_equal     ¬¬-- system called in FIX mode, so file updated                                                                                                                        
     exec     ... review line                      yENV_peek                   YURG_MSG                      , 'Ö'                                                                   s_equal     ¬¬-- regular (r) entry existance confirmed, AND not a symlink/hardlink                                                                                                                      
     exec     ... review line                      yENV_peek                   YURG_MSG                      , 'Ö'                                                                   s_equal     ¬¬-- ownership confirmed, owned by årootæ (0) and in group årootæ (0)                                                                                                                              
     exec     ... review line                      yENV_peek                   YURG_MSG                      , 'Ö'                                                                   s_equal     ¬¬-- permissions confirmed, åf_tightæ, 0600, disp årw-------æ                                                                                                
     exec     ... review line                      yENV_peek                   YURG_MSG                      , 'Ö'                                                                   s_equal     (n/a)                                                                                                                                                 
     exec     verify errors output                 yENV_lines                  YURG_ERR                                                                                              i_equal     1                                                                                                    
     code     create error message                 - - - - - - - - - - - - -   strcpy (u_error, "  " BOLD_YEL "** warning, troubles with entry perms" BOLD_OFF);                                                                                                                                         
     exec     ... review line                      yENV_peek                   YURG_ERR                      , 0                                                                     s_equal     [[ u_error ]]                                                                                        
     exec     ... review line                      yENV_peek                   YURG_ERR                      , 'Ö'                                                                   s_equal     (n/a)                                                                                                

   DITTO (0)  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((18.008))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       end the test                                                       - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     wrap up testing                      yENV__unit_end                                                                                                                    i_equal     0                                                                                                    



